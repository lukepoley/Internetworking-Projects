<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" type="text/css" />
  <title>A Journey Through Internet Routing: BGP, Traceroutes, and the Paths We Take</title>
  <!-- HTML from https://niklasfasching.de/posts/just-enough-css/ -->
</head>
<body>
  <header class='header'></header>
  <div class="container">
    <h1 class="title">A Journey Through Internet Routing: BGP, Traceroutes, and the Paths We Take
      <br>
      <span class="subtitle">Luke Poley - CS 331</span>
    </h1>

    <h2 id="headline-1">Introduction: The Internet's Hidden Highways</h2>
    <p>
      The internet is often described as a "network of networks." But what does that actually mean? How does a request from your computer in one corner of the world find its way to a server on another continent? The answer lies in a complex system of routing protocols that govern how traffic is exchanged between the thousands of independent networks, or <a href="https://www.cloudflare.com/learning/network-layer/what-is-an-autonomous-system/">Autonomous Systems (ASes)</a>, that make up the global internet.
    </p>
    <p>
      This post explores the fascinating world of internet routing by comparing two key tools: the <a href="https://www.cloudflare.com/learning/security/glossary/what-is-bgp/">Border Gateway Protocol</a>, which dictates the preferred routes between ASes, and traceroute, which shows the actual path a packet takes. We'll analyze the routes to several well-known websites, uncovering the hidden complexities of internet routing and the reasons why the "best" path isn't always the one that's taken.
    </p>
    <img src="network-of-networks.svg" alt="A topology of the internet being a network of networks">

    <h2 id="headline-2">Understanding the Tools</h2>
    <h3 id="headline-2.1">BGP and RouteViews: The Internet's Road Map</h3>
    <p>
      The <strong><a href="https://www.cloudflare.com/learning/security/glossary/what-is-bgp/">Border Gateway Protocol</a> (BGP)</strong> is the routing protocol of the internet. It's used to exchange routing information between <a href="https://www.cloudflare.com/learning/network-layer/what-is-an-autonomous-system/">Autonomous Systems (ASes)</a>, which are large networks typically operated by a single entity like an Internet Service Provider (ISP), a university, or a large tech company. BGP allows each AS to advertise the IP address blocks it controls and the paths it knows to other destinations.
    </p>
    <p>
      The <strong><a href="https://www.routeviews.org/routeviews/">RouteViews</a></strong> project provides a public window into the BGP routing tables of the internet. By collecting data from hundreds of volunteer routers worldwide, RouteViews allows us to see the preferred paths between ASes for any given destination. This is like having access to the internet's "road map," showing the intended routes based on policies and business relationships between network operators.
    </p>
    <figure>
      <img src="Routing-1.png">
      <figcaption> The diagram above illustrates how different ASes connect to each other to with routing tables' best path versus all paths.<sup class="footnote-reference"><a id="footnote-reference-1" href="#footnote-2">2</a></sup> </figcaption>
    </figure>

    <h3 id="headline-2.2">Traceroute: Following the Actual Path</h3>
    <p>
      A <strong>traceroute</strong> is a diagnostic tool that allows us to trace the path a packet of data takes from a source to a destination. It does this by sending a series of packets with increasing "time-to-live" (TTL) values. Each router along the path decrements the TTL, and when it reaches zero, the router sends back a message. This allows traceroute to identify the IP addresses of the routers, or "hops," along the path.
    </p>

    <h2 id="headline-3">BGP vs. Traceroute: Two Paths to Stanford</h2>
    <p>
      One of the most interesting aspects of internet routing is that the path a packet actually takes (as shown by a traceroute) can be different from the "best" path advertised by BGP. A great example of this is the route to Stanford University (AS32).
    </p>
    <ul>
      <li>
        <strong>The BGP Path (from the Chicago RouteView collector):</strong> The preferred BGP path from Chicago to Stanford is relatively short and direct, involving just a few ASes:
        <ul>
          <li><code>293 &rarr; 2153 &rarr; 32 (Stanford University)</code></li>
        </ul>
        This path utilizes commercial internet backbones to get to the West Coast.
      </li>
      <li>
        <strong>The Traceroute Path (from Carleton College):</strong> A traceroute from Carleton College to Stanford, however, reveals a completely different path:
        <ul>
          <li>The traceroute from Carleton shows a path that goes through several cities: Twin Cities &rarr; Fargo &rarr; Sacramento &rarr; Sunnyvale &rarr; Stanford.
          </li>
        </ul>
        This path utilizes a research and education (R&E) network, which is separate from the commercial internet. Carleton, as an academic institution, has access to this network, which is optimized for academic traffic.
      </li>
    </ul>
    <p>
      This difference highlights a key concept in internet routing: <strong>policy-based routing</strong>. Carleton's network is configured to send academic traffic over the R&E network, even if the commercial path advertised by BGP is shorter in terms of AS hops. This is because the R&E network may offer better performance or lower cost for this type of traffic.
    </p>

    <h2 id="headline-4">AS Path Analysis: A Closer Look at the Routes</h2>
    <p>
      The AS path is the sequence of Autonomous Systems a route announcement traverses to reach a destination. The length of the AS path is a key factor in BGP path selection, with shorter paths generally being preferred.
    </p>
    <p>
      Let's look at the AS paths to a few different destinations, as seen from the RouteViews collector in Chicago. The path from Carleton College (AS26557, which is not a public AS number) to its provider, Hurricane Electric (AS6939), is prepended to the paths.
    </p>
    <ul>
      <li>The route to <strong>db.com</strong> (Deutsche Bank), which is hosted on Google Cloud (AS396982), has the following AS path:
        <ul>
          <li><code>6939 (Hurricane Electric) &rarr; 199524 (G-Core Labs) &rarr; 15169 (Google) &rarr; 396982 (Google Cloud)</code></li>
        </ul>
      </li>
    </ul>

    <div class="table_component" role="region" tabindex="0">
      <table>
        <h3 id="headline-4.1">AS Path Length Variation per Endpoint</h3>
        <thead>
          <tr>
            <th>Endpoint</th>
            <th>Total Routes</th>
            <th>Min Path Length</th>
            <th>Max Path Length</th>
            <th>Difference</th>
            <th>Median Path Length</th>
            <th>Average Path Length</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>stanford.edu</td>
            <td>18</td>
            <td>7</td>
            <td>10</td>
            <td>3</td>
            <td>9</td>
            <td>8.78</td>
          </tr>
          <tr>
            <td>uct.ac.za</td>
            <td>16</td>
            <td>7</td>
            <td>10</td>
            <td>3</td>
            <td>9</td>
            <td>8.75</td>
          </tr>
          <tr>
            <td>regex101.com</td>
            <td>16</td>
            <td>6</td>
            <td>9</td>
            <td>3</td>
            <td>8</td>
            <td>7.69</td>
          </tr>
          <tr>
            <td>db.com</td>
            <td>16</td>
            <td>7</td>
            <td>8</td>
            <td>1</td>
            <td>7</td>
            <td>7.25</td>
          </tr>
          <tr>
            <td>corndog.io</td>
            <td>16</td>
            <td>7</td>
            <td>9</td>
            <td>2</td>
            <td>8</td>
            <td>7.75</td>
          </tr>
          <tr>
            <td>baidu.com</td>
            <td>16</td>
            <td>8</td>
            <td>12</td>
            <td>4</td>
            <td>8</td>
            <td>8.25</td>
          </tr>
        </tbody>
      </table>
    </div>

    <h2 id="headline-5">Key Observations and Analysis</h2>
    <h3 id="headline-5.1">AS Path Length and Route Stability</h3>
    <p>
      The table above shows the variation in AS path length for different destinations.
    </p>
    <ul>
      <li>
        <strong>Low Variance (e.g., db.com):</strong> Domestic sites like db.com show low variance in path length. This indicates that there are many direct and efficient routes available, resulting in stable and predictable routing.
      </li>
      <li>
        <strong>High Variance (e.g., baidu.com, uct.ac.za):</strong> International sites like baidu.com (China) and uct.ac.za (South Africa) show high variance in path length. This is due to the complexities of long-haul routing, which often involves multiple international carriers and undersea cables.
      </li>
    </ul>

    <h3 id="headline-5.2">The Most Frequent ASes</h3>
    <div class="table_component" role="region" tabindex="0">
      <table>
        <h3 id="headline-5.2.1">AS Frequency per Endpoint</h3>
        <thead>
          <tr>
            <th>Endpoint / Prefix</th>
            <th>Top 3 Most Frequent ASes (excluding the Origin AS)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>stanford.edu (171.64.0.0/14)</td>
            <td>AS46749 (Stanford) (13 times), AS6939 (Hurricane Electric) (9 times), AS2152 (CENIC) (3 times)</td>
          </tr>
          <tr>
            <td>uct.ac.za (137.158.0.0/16)</td>
            <td>AS20080 (9 times), AS2914 (NTT) (6 times), AS1299 (Arelion) (5 times)</td>
          </tr>
          <tr>
            <td>regex101.com (78.46.0.0/15)</td>
            <td>AS1299 (Arelion) (8 times), AS2914 (NTT) (5 times), AS17350 (2 times)</td>
          </tr>
          <tr>
            <td>db.com (34.96.0.0/20)</td>
            <td>AS15169 (Google) (15 times), AS49544 (i3D.net) (1 time), AS14016 (Capcon) (1 time)</td>
          </tr>
          <tr>
            <td>corndog.io (192.30.252.0/24)</td>
            <td>AS1299 (Arelion) (9 times), AS6461 (Zayo) (2 times), AS2914 (NTT) (2 times)</td>
          </tr>
          <tr>
            <td>baidu.com (220.181.0.0/19)</td>
            <td>AS4134 (China Telecom) (19 times), AS1299 (Arelion) (6 times), AS2914 (NTT) / AS3356 (Lumen) (3 times each)</td>
          </tr>
        </tbody>
      </table>
    </div>
    <ul>
      <li>
        <strong>AS1299 (Arelion):</strong> This Tier 1 provider appears frequently in the routes to many different destinations. This is because Tier 1 providers have a global reach and are a common choice for long-haul transit.
      </li>
      <li>
        <strong>AS4134 (China Telecom):</strong> This AS appears many times in the path to baidu.com due to a technique called  <a href="https://www.juniper.net/documentation/us/en/software/junos/routing-policy/topics/concept/policy-prepending-as-numbers-to-bgp-as-paths.html">AS-prepending</a>. By artificially lengthening the AS path, China Telecom can influence which paths are chosen for its traffic, a form of traffic engineering.
      </li>
    </ul>
    <figure>
      <img src="autonomous-system-diagram.svg" alt="An autonomous system diagram around a globe">
      <figcaption> The diagram above illustrates how different ASes connect to each other to form the global internet. </figcaption>
    </figure>

    <h2 id="headline-6">The Internet is a Dynamic System</h2>
    <p>
      As we've seen, internet routing is a complex and dynamic process. The "best" path to a destination depends on a variety of factors, including the policies of the networks involved, the physical infrastructure, and the business relationships between providers. By using tools like BGP RouteViews and traceroute, we can gain a deeper understanding of how the internet works and the hidden complexities that make it all possible.
    </p>

    <div id="outline-container-headline-7" class="outline-2">
      <h2 id="headline-7">Footnotes</h2>
    </div>
    <div class="footnotes">
      <hr class="footnotes-separatator">
      <div class="footnote-definitions">
        <div class="footnote-definition">
          <sup id="footnote-1"><a href="#footnote-reference-1">1</a></sup>
          <div class="footnote-body">
            <ul>
              <li><a href="https://www.cloudflare.com/learning/security/glossary/what-is-bgp/">What is BGP? - Cloudflare</a></li>
              <li><a href="https://www.cloudflare.com/learning/network-layer/what-is-an-autonomous-system/">What is an Autonomous System? - Cloudflare</a></li>
            </ul>
          </div>
          <sup id="footnote-2"><a href="#footnote-reference-2">2</a></sup>
          <div class="footnote-body">
            <ul>
              <li><a href="https://www.ipxo.com/blog/what-is-asn/">What is asn - IPXO</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
